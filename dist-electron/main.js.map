{"version":3,"file":"main.js","sources":["../src/main/onion/install/downloader.ts","../src/main/onion/install/verify.ts","../src/main/onion/install/unpack.ts","../src/main/onion/pinnedHashes.ts","../src/main/onion/componentRegistry.ts","../src/main/onion/install/swapperRollback.ts","../src/main/onion/errors.ts","../src/main/onion/assetNaming.ts","../src/main/onion/install/installTor.ts","../src/main/onion/install/installLokinet.ts","../src/main/onion/runtime/torManager.ts","../src/main/onion/runtime/lokinetManager.ts","../src/main/onion/runtime/onionRuntime.ts","../src/main/onion/update/checkUpdates.ts","../src/main.ts"],"sourcesContent":["import fs from \"node:fs\";\nimport https from \"node:https\";\nimport { pipeline } from \"node:stream/promises\";\n\nexport type DownloadProgress = {\n  receivedBytes: number;\n  totalBytes: number;\n};\n\nconst getResponse = async (url: string, redirects = 0): Promise<https.IncomingMessage> => {\n  if (redirects > 5) {\n    throw new Error(\"Too many redirects\");\n  }\n  const response = await new Promise<https.IncomingMessage>((resolve, reject) => {\n    const req = https.get(\n      url,\n      { headers: { \"User-Agent\": \"nkc-onion-installer\" } },\n      (res) => resolve(res)\n    );\n    req.on(\"error\", reject);\n  });\n  if (response.statusCode && [301, 302, 307, 308].includes(response.statusCode)) {\n    const redirect = response.headers.location;\n    response.resume();\n    if (!redirect) {\n      throw new Error(\"Redirect missing location header\");\n    }\n    return getResponse(redirect, redirects + 1);\n  }\n  if (response.statusCode && response.statusCode >= 400) {\n    throw new Error(`Download failed: ${response.statusCode}`);\n  }\n  return response;\n};\n\nexport const downloadFile = async (\n  url: string,\n  dest: string,\n  onProgress?: (progress: DownloadProgress) => void\n) => {\n  const request = await getResponse(url);\n\n  const totalBytes = Number(request.headers[\"content-length\"] ?? 0);\n  let receivedBytes = 0;\n  request.on(\"data\", (chunk) => {\n    receivedBytes += chunk.length;\n    onProgress?.({ receivedBytes, totalBytes });\n  });\n\n  await pipeline(request, fs.createWriteStream(dest));\n};\n","import crypto from \"node:crypto\";\nimport fs from \"node:fs\";\n\nconst hashFile = async (filePath: string) => {\n  const hash = crypto.createHash(\"sha256\");\n  const stream = fs.createReadStream(filePath);\n  return new Promise<string>((resolve, reject) => {\n    stream.on(\"data\", (chunk) => hash.update(chunk));\n    stream.on(\"error\", reject);\n    stream.on(\"end\", () => resolve(hash.digest(\"hex\")));\n  });\n};\n\nexport const verifySha256 = async (filePath: string, expectedSha256: string) => {\n  const actual = await hashFile(filePath);\n  if (actual.toLowerCase() !== expectedSha256.toLowerCase()) {\n    throw new Error(\"SHA256 mismatch\");\n  }\n};\n","import { execFile } from \"node:child_process\";\nimport path from \"node:path\";\n\nexport const unpackArchive = async (archivePath: string, destDir: string) => {\n  const lowerPath = archivePath.toLowerCase();\n  if (lowerPath.endsWith(\".zip\")) {\n    await new Promise<void>((resolve, reject) => {\n      if (process.platform === \"win32\") {\n        execFile(\n          \"powershell\",\n          [\n            \"-NoProfile\",\n            \"-Command\",\n            `Expand-Archive -Force -Path '${archivePath}' -DestinationPath '${destDir}'`,\n          ],\n          (error) => {\n            if (error) reject(error);\n            else resolve();\n          }\n        );\n        return;\n      }\n      execFile(\"unzip\", [\"-o\", archivePath, \"-d\", destDir], (error) => {\n        if (error) reject(error);\n        else resolve();\n      });\n    });\n    return;\n  }\n  if (\n    lowerPath.endsWith(\".tar.gz\") ||\n    lowerPath.endsWith(\".tgz\") ||\n    lowerPath.endsWith(\".tar.xz\")\n  ) {\n    await new Promise<void>((resolve, reject) => {\n      execFile(\"tar\", [\"-xf\", archivePath, \"-C\", destDir], (error) => {\n        if (error) reject(error);\n        else resolve();\n      });\n    });\n    return;\n  }\n  throw new Error(\"Unsupported archive format\");\n};\n","export type PinnedKeyParts = {\n  platform: NodeJS.Platform;\n  arch: NodeJS.Architecture;\n  version: string;\n  filename: string;\n};\n\nexport const makePinnedKey = (parts: PinnedKeyParts) =>\n  `${parts.platform}:${parts.arch}:${parts.version}:${parts.filename}`;\n\nexport const pinnedSha256 = {\n  tor: {\n    [makePinnedKey({ platform: \"android\", arch: \"arm64\", version: \"15.0.4\", filename: \"tor-expert-bundle-android-aarch64-15.0.4.tar.gz\" })]: \"b1582efca86db843bb4fa435edd766086a77334b32924a72686894212d5e5955\",\n    [makePinnedKey({ platform: \"android\", arch: \"arm\", version: \"15.0.4\", filename: \"tor-expert-bundle-android-armv7-15.0.4.tar.gz\" })]: \"fdb2d8ed01e40506f1518ef3e5f83a3d62e6f5ac0f8798917532798d6c05771f\",\n    [makePinnedKey({ platform: \"android\", arch: \"ia32\", version: \"15.0.4\", filename: \"tor-expert-bundle-android-x86-15.0.4.tar.gz\" })]: \"c92f7ffbf105e0ae195e28ac516648b54ba1323f24b47ae236a6d711c7daffe2\",\n    [makePinnedKey({ platform: \"android\", arch: \"x64\", version: \"15.0.4\", filename: \"tor-expert-bundle-android-x86_64-15.0.4.tar.gz\" })]: \"0adf0201950c02d36897569576eff37718d4afe1835052a3bc424b78be1a0605\",\n    [makePinnedKey({ platform: \"linux\", arch: \"ia32\", version: \"15.0.4\", filename: \"tor-expert-bundle-linux-i686-15.0.4.tar.gz\" })]: \"228d1a1ccd2683b8c6abc4fd701ebdc7b59254bae47b6acd253cb6aea9338a50\",\n    [makePinnedKey({ platform: \"linux\", arch: \"x64\", version: \"15.0.4\", filename: \"tor-expert-bundle-linux-x86_64-15.0.4.tar.gz\" })]: \"b9d0cbb76b2d8cca37313393b7b02a931e8b63d58aacbeed18b24d5cbb887fe8\",\n    [makePinnedKey({ platform: \"darwin\", arch: \"arm64\", version: \"15.0.4\", filename: \"tor-expert-bundle-macos-aarch64-15.0.4.tar.gz\" })]: \"8f0a9dc1020b2d7a89356a6aabefb95663614b132790ea484381ccb669e2d255\",\n    [makePinnedKey({ platform: \"darwin\", arch: \"x64\", version: \"15.0.4\", filename: \"tor-expert-bundle-macos-x86_64-15.0.4.tar.gz\" })]: \"1577938b499f46b8cdfa6643c4bb982309ee48fcaa08e3d32ac64e2dd8c16830\",\n    [makePinnedKey({ platform: \"win32\", arch: \"ia32\", version: \"15.0.4\", filename: \"tor-expert-bundle-windows-i686-15.0.4.tar.gz\" })]: \"f1da12f12f0b49ffbbbe99d7a1994b5f7f5e6ced33e4f41d3a520d0d9c445a21\",\n    [makePinnedKey({ platform: \"win32\", arch: \"x64\", version: \"15.0.4\", filename: \"tor-expert-bundle-windows-x86_64-15.0.4.tar.gz\" })]: \"cce12f8097b1657b56e22ec54cbed4b57fd5f8ff97cc426c21ebd5cc15173924\",\n  },\n  lokinet: {\n    [makePinnedKey({ platform: \"linux\", arch: \"x64\", version: \"0.9.14\", filename: \"lokinet-linux-amd64-v0.9.14.tar.xz\" })]: \"4097f96779a007abf35f37a46394eb5af39debd27244c190ce6867caf7a5115d\",\n  },\n} as const;\n","import path from \"node:path\";\nimport type { OnionNetwork } from \"../../net/netConfig\";\nimport { makePinnedKey, pinnedSha256 } from \"./pinnedHashes\";\n\nexport type ComponentDownload = {\n  version: string;\n  assetName: string;\n  url: string;\n  sha256: string;\n};\n\ntype ComponentRegistryEntry = {\n  id: OnionNetwork;\n  displayName: string;\n  binaryPath: string;\n  pinnedSha256: Record<string, string>;\n};\n\nconst torEntry: ComponentRegistryEntry = {\n  id: \"tor\",\n  displayName: \"Tor\",\n  binaryPath: path.join(\"Tor\", \"tor.exe\"),\n  pinnedSha256: pinnedSha256.tor,\n};\n\nconst lokinetEntry: ComponentRegistryEntry = {\n  id: \"lokinet\",\n  displayName: \"Lokinet\",\n  binaryPath: \"lokinet.exe\",\n  pinnedSha256: pinnedSha256.lokinet,\n};\n\nexport const componentRegistry: Record<OnionNetwork, ComponentRegistryEntry> = {\n  tor: torEntry,\n  lokinet: lokinetEntry,\n};\n\nexport const getBinaryPath = (network: OnionNetwork) => componentRegistry[network].binaryPath;\n\nexport type PinnedHashLookup = {\n  platform?: NodeJS.Platform;\n  arch?: NodeJS.Architecture;\n  version: string;\n  assetName: string;\n};\n\nexport const getPinnedSha256 = (network: OnionNetwork, lookup: PinnedHashLookup) => {\n  const key = makePinnedKey({\n    platform: lookup.platform ?? process.platform,\n    arch: lookup.arch ?? process.arch,\n    version: lookup.version,\n    filename: lookup.assetName,\n  });\n  return componentRegistry[network].pinnedSha256[key];\n};\n","import fs from \"node:fs/promises\";\nimport path from \"node:path\";\nimport type { OnionNetwork } from \"../../net/netConfig\";\n\ntype CurrentPointer = {\n  version: string;\n  path: string;\n};\n\nconst currentFileName = \"current.json\";\n\nconst getComponentRoot = (userDataDir: string, network: OnionNetwork) =>\n  path.join(userDataDir, \"onion\", \"components\", network);\n\nconst getPointerPath = (userDataDir: string, network: OnionNetwork) =>\n  path.join(getComponentRoot(userDataDir, network), currentFileName);\n\nconst writeJsonAtomic = async (filePath: string, data: CurrentPointer) => {\n  const tempPath = `${filePath}.tmp`;\n  await fs.mkdir(path.dirname(filePath), { recursive: true });\n  await fs.writeFile(tempPath, JSON.stringify(data, null, 2));\n  await fs.rename(tempPath, filePath);\n};\n\nexport const readCurrentPointer = async (userDataDir: string, network: OnionNetwork) => {\n  try {\n    const raw = await fs.readFile(getPointerPath(userDataDir, network), \"utf8\");\n    return JSON.parse(raw) as CurrentPointer;\n  } catch (error) {\n    return null;\n  }\n};\n\nexport const swapWithRollback = async (\n  userDataDir: string,\n  network: OnionNetwork,\n  next: CurrentPointer\n) => {\n  const previous = await readCurrentPointer(userDataDir, network);\n  await writeJsonAtomic(getPointerPath(userDataDir, network), next);\n  return async () => {\n    if (previous) {\n      await writeJsonAtomic(getPointerPath(userDataDir, network), previous);\n    }\n  };\n};\n","export class PinnedHashMissingError extends Error {\n  readonly code = \"PINNED_HASH_MISSING\";\n  readonly details: string;\n\n  constructor(details: string) {\n    super(\"PINNED_HASH_MISSING\");\n    this.name = \"PinnedHashMissingError\";\n    this.details = details;\n  }\n}\n","const TOR_RELEASE_BASE = \"https://dist.torproject.org/torbrowser\";\n\nconst getTorPlatformLabel = (platform: NodeJS.Platform) => {\n  switch (platform) {\n    case \"win32\":\n      return \"windows\";\n    case \"darwin\":\n      return \"macos\";\n    case \"linux\":\n      return \"linux\";\n    case \"android\":\n      return \"android\";\n    default:\n      return platform;\n  }\n};\n\nconst getTorArchLabel = (arch: NodeJS.Architecture) => {\n  switch (arch) {\n    case \"x64\":\n      return \"x86_64\";\n    case \"ia32\":\n      return \"i686\";\n    case \"arm64\":\n      return \"aarch64\";\n    case \"arm\":\n      return \"armv7\";\n    default:\n      return arch;\n  }\n};\n\nexport const getTorAssetName = (\n  version: string,\n  platform: NodeJS.Platform = process.platform,\n  arch: NodeJS.Architecture = process.arch\n) =>\n  `tor-expert-bundle-${getTorPlatformLabel(platform)}-${getTorArchLabel(arch)}-${version}.tar.gz`;\n\nexport const getTorAssetUrl = (\n  version: string,\n  platform: NodeJS.Platform = process.platform,\n  arch: NodeJS.Architecture = process.arch\n) => `${TOR_RELEASE_BASE}/${version}/${getTorAssetName(version, platform, arch)}`;\n","import fs from \"node:fs/promises\";\nimport path from \"node:path\";\nimport type { OnionNetwork } from \"../../net/netConfig\";\nimport { downloadFile } from \"./downloader\";\nimport { verifySha256 } from \"./verify\";\nimport { unpackArchive } from \"./unpack\";\nimport { getPinnedSha256 } from \"../componentRegistry\";\nimport { swapWithRollback } from \"./swapperRollback\";\nimport { PinnedHashMissingError } from \"../errors\";\nimport { getTorAssetName, getTorAssetUrl } from \"../assetNaming\";\n\ntype InstallProgress = {\n  step: \"download\" | \"verify\" | \"unpack\" | \"activate\";\n  message?: string;\n  receivedBytes?: number;\n  totalBytes?: number;\n};\n\ntype InstallResult = {\n  version: string;\n  installPath: string;\n  rollback: () => Promise<void>;\n};\n\nconst resolveDownload = (version: string) => {\n  const assetName = getTorAssetName(version);\n  return {\n    assetName,\n    url: getTorAssetUrl(version),\n  };\n};\n\nexport const installTor = async (\n  userDataDir: string,\n  version: string,\n  onProgress?: (progress: InstallProgress) => void,\n  downloadUrl?: string,\n  assetNameOverride?: string\n): Promise<InstallResult> => {\n  const network: OnionNetwork = \"tor\";\n  const { assetName, url } = resolveDownload(version);\n  const resolvedAssetName = assetNameOverride ?? assetName;\n  const hash = getPinnedSha256(network, { version, assetName: resolvedAssetName });\n  if (!hash) {\n    throw new PinnedHashMissingError(\n      `Missing pinned hash for Tor asset ${resolvedAssetName} (${version}).`\n    );\n  }\n\n  const tempDir = await fs.mkdtemp(path.join(userDataDir, \"onion\", \"tmp-\"));\n  const resolvedUrl = downloadUrl ?? url;\n  const archivePath = path.join(tempDir, resolvedAssetName);\n  onProgress?.({ step: \"download\", message: \"Downloading Tor\" });\n  await downloadFile(resolvedUrl, archivePath, (progress) =>\n    onProgress?.({ step: \"download\", ...progress })\n  );\n  onProgress?.({ step: \"verify\", message: \"Verifying Tor\" });\n  await verifySha256(archivePath, hash);\n\n  const installPath = path.join(userDataDir, \"onion\", \"components\", network, version);\n  await fs.rm(installPath, { recursive: true, force: true });\n  await fs.mkdir(installPath, { recursive: true });\n  onProgress?.({ step: \"unpack\", message: \"Unpacking Tor\" });\n  await unpackArchive(archivePath, installPath);\n  onProgress?.({ step: \"activate\", message: \"Activating Tor\" });\n  const rollback = await swapWithRollback(userDataDir, network, { version, path: installPath });\n  return { version, installPath, rollback };\n};\n","import fs from \"node:fs/promises\";\nimport path from \"node:path\";\nimport type { OnionNetwork } from \"../../net/netConfig\";\nimport { downloadFile } from \"./downloader\";\nimport { verifySha256 } from \"./verify\";\nimport { unpackArchive } from \"./unpack\";\nimport { getPinnedSha256 } from \"../componentRegistry\";\nimport { swapWithRollback } from \"./swapperRollback\";\nimport { PinnedHashMissingError } from \"../errors\";\n\ntype InstallProgress = {\n  step: \"download\" | \"verify\" | \"unpack\" | \"activate\";\n  message?: string;\n  receivedBytes?: number;\n  totalBytes?: number;\n};\n\ntype InstallResult = {\n  version: string;\n  installPath: string;\n  rollback: () => Promise<void>;\n};\n\nconst LOKINET_RELEASE_BASE = \"https://github.com/oxen-io/lokinet/releases/download\";\n\nconst resolveDownload = (version: string, assetNameOverride?: string) => {\n  const assetName = assetNameOverride ?? `lokinet-win32-${version}.zip`;\n  return {\n    assetName,\n    url: `${LOKINET_RELEASE_BASE}/v${version}/${assetName}`,\n  };\n};\n\nexport const installLokinet = async (\n  userDataDir: string,\n  version: string,\n  onProgress?: (progress: InstallProgress) => void,\n  downloadUrl?: string,\n  assetNameOverride?: string\n): Promise<InstallResult> => {\n  const network: OnionNetwork = \"lokinet\";\n  const { assetName, url } = resolveDownload(version, assetNameOverride);\n  const hash = getPinnedSha256(network, { version, assetName });\n  if (!hash) {\n    throw new PinnedHashMissingError(\n      `Missing pinned hash for Lokinet asset ${assetName} (${version}).`\n    );\n  }\n\n  const tempDir = await fs.mkdtemp(path.join(userDataDir, \"onion\", \"tmp-\"));\n  const resolvedUrl = downloadUrl ?? url;\n  const archivePath = path.join(tempDir, assetName);\n  onProgress?.({ step: \"download\", message: \"Downloading Lokinet\" });\n  await downloadFile(resolvedUrl, archivePath, (progress) =>\n    onProgress?.({ step: \"download\", ...progress })\n  );\n  onProgress?.({ step: \"verify\", message: \"Verifying Lokinet\" });\n  await verifySha256(archivePath, hash);\n\n  const installPath = path.join(userDataDir, \"onion\", \"components\", network, version);\n  await fs.rm(installPath, { recursive: true, force: true });\n  await fs.mkdir(installPath, { recursive: true });\n  onProgress?.({ step: \"unpack\", message: \"Unpacking Lokinet\" });\n  await unpackArchive(archivePath, installPath);\n  onProgress?.({ step: \"activate\", message: \"Activating Lokinet\" });\n  const rollback = await swapWithRollback(userDataDir, network, { version, path: installPath });\n  return { version, installPath, rollback };\n};\n","import { spawn } from \"node:child_process\";\nimport path from \"node:path\";\nimport type { ChildProcessWithoutNullStreams } from \"node:child_process\";\n\ntype TorManagerState = {\n  running: boolean;\n  pid?: number;\n};\n\nexport class TorManager {\n  private process: ChildProcessWithoutNullStreams | null = null;\n  private state: TorManagerState = { running: false };\n\n  async start(binaryPath: string, socksPort: number, dataDir: string) {\n    if (this.process) return;\n    const args = [\"--SocksPort\", `127.0.0.1:${socksPort}`, \"--DataDirectory\", dataDir];\n    this.process = spawn(binaryPath, args, { stdio: \"ignore\" });\n    this.state = { running: true, pid: this.process.pid };\n    this.process.on(\"exit\", () => {\n      this.state = { running: false };\n      this.process = null;\n    });\n  }\n\n  async stop() {\n    if (!this.process) return;\n    this.process.kill();\n    this.process = null;\n    this.state = { running: false };\n  }\n\n  getState() {\n    return this.state;\n  }\n}\n","import { spawn } from \"node:child_process\";\nimport type { ChildProcessWithoutNullStreams } from \"node:child_process\";\n\ntype LokinetManagerState = {\n  running: boolean;\n  pid?: number;\n};\n\nexport class LokinetManager {\n  private process: ChildProcessWithoutNullStreams | null = null;\n  private state: LokinetManagerState = { running: false };\n\n  async start(binaryPath: string, socksPort: number, dataDir: string) {\n    if (this.process) return;\n    const args = [\"--socks-port\", String(socksPort), \"--data-dir\", dataDir];\n    this.process = spawn(binaryPath, args, { stdio: \"ignore\" });\n    this.state = { running: true, pid: this.process.pid };\n    this.process.on(\"exit\", () => {\n      this.state = { running: false };\n      this.process = null;\n    });\n  }\n\n  async stop() {\n    if (!this.process) return;\n    this.process.kill();\n    this.process = null;\n    this.state = { running: false };\n  }\n\n  getState() {\n    return this.state;\n  }\n}\n","import net from \"node:net\";\nimport path from \"node:path\";\nimport { session } from \"electron\";\nimport { getBinaryPath } from \"../componentRegistry\";\nimport type { OnionNetwork } from \"../../net/netConfig\";\nimport { readCurrentPointer } from \"../install/swapperRollback\";\nimport { TorManager } from \"./torManager\";\nimport { LokinetManager } from \"./lokinetManager\";\n\ntype RuntimeStatus = {\n  status: \"idle\" | \"starting\" | \"running\" | \"failed\";\n  network?: OnionNetwork;\n  socksPort?: number;\n  error?: string;\n};\n\nconst PORT_START = 9050;\nconst PORT_END = 9070;\n\nconst findAvailablePort = async () => {\n  for (let port = PORT_START; port <= PORT_END; port += 1) {\n    const isFree = await new Promise<boolean>((resolve) => {\n      const server = net.createServer();\n      server.once(\"error\", () => resolve(false));\n      server.once(\"listening\", () => {\n        server.close(() => resolve(true));\n      });\n      server.listen(port, \"127.0.0.1\");\n    });\n    if (isFree) return port;\n  }\n  throw new Error(\"No available SOCKS port\");\n};\n\nconst waitForPort = async (port: number, timeoutMs = 10000) => {\n  const start = Date.now();\n  while (Date.now() - start < timeoutMs) {\n    const ok = await new Promise<boolean>((resolve) => {\n      const socket = net.createConnection({ host: \"127.0.0.1\", port }, () => {\n        socket.end();\n        resolve(true);\n      });\n      socket.on(\"error\", () => resolve(false));\n    });\n    if (ok) return;\n    await new Promise((resolve) => setTimeout(resolve, 250));\n  }\n  throw new Error(\"SOCKS proxy not ready\");\n};\n\nexport class OnionRuntime {\n  private torManager = new TorManager();\n  private lokinetManager = new LokinetManager();\n  private status: RuntimeStatus = { status: \"idle\" };\n\n  async start(userDataDir: string, network: OnionNetwork) {\n    if (this.status.status === \"running\" && this.status.network === network) return;\n    await this.stop();\n    this.status = { status: \"starting\", network };\n    try {\n      const pointer = await readCurrentPointer(userDataDir, network);\n      if (!pointer) {\n        throw new Error(\"Component not installed\");\n      }\n\n      const port = await findAvailablePort();\n      const dataDir = path.join(userDataDir, \"onion\", \"runtime\", network);\n      const binaryPath = path.join(pointer.path, getBinaryPath(network));\n\n      if (network === \"tor\") {\n        await this.torManager.start(binaryPath, port, dataDir);\n      } else {\n        await this.lokinetManager.start(binaryPath, port, dataDir);\n      }\n\n      await waitForPort(port);\n      await session.defaultSession.setProxy({ proxyRules: `socks5://127.0.0.1:${port}` });\n      this.status = { status: \"running\", network, socksPort: port };\n    } catch (error) {\n      this.status = {\n        status: \"failed\",\n        network,\n        error: error instanceof Error ? error.message : String(error),\n      };\n      throw error;\n    }\n  }\n\n  async stop() {\n    await this.torManager.stop();\n    await this.lokinetManager.stop();\n    await session.defaultSession.setProxy({ mode: \"direct\" });\n    this.status = { status: \"idle\" };\n  }\n\n  getStatus() {\n    return {\n      ...this.status,\n      tor: this.torManager.getState(),\n      lokinet: this.lokinetManager.getState(),\n    };\n  }\n}\n","import https from \"node:https\";\nimport type { OnionNetwork } from \"../../net/netConfig\";\nimport { getPinnedSha256 } from \"../componentRegistry\";\nimport { getTorAssetName, getTorAssetUrl } from \"../assetNaming\";\n\ntype ReleaseAsset = {\n  name: string;\n  browser_download_url: string;\n};\n\ntype ReleaseResponse = {\n  tag_name: string;\n  assets: ReleaseAsset[];\n};\n\ntype UpdateCheckResult = {\n  version: string | null;\n  assetName: string | null;\n  downloadUrl: string | null;\n  sha256: string | null;\n  errorCode?: \"PINNED_HASH_MISSING\" | \"ASSET_NOT_FOUND\";\n};\n\nconst fetchJson = async <T,>(url: string): Promise<T> => {\n  return new Promise((resolve, reject) => {\n    https\n      .get(\n        url,\n        { headers: { \"User-Agent\": \"nkc-onion-updater\" } },\n        (res) => {\n          if (res.statusCode && res.statusCode >= 400) {\n            reject(new Error(`Update check failed: ${res.statusCode}`));\n            return;\n          }\n          let raw = \"\";\n          res.setEncoding(\"utf8\");\n          res.on(\"data\", (chunk) => {\n            raw += chunk;\n          });\n          res.on(\"end\", () => {\n            try {\n              resolve(JSON.parse(raw) as T);\n            } catch (error) {\n              reject(error);\n            }\n          });\n        }\n      )\n      .on(\"error\", reject);\n  });\n};\n\nconst fetchText = async (url: string): Promise<string> => {\n  return new Promise((resolve, reject) => {\n    https\n      .get(url, { headers: { \"User-Agent\": \"nkc-onion-updater\" } }, (res) => {\n        if (res.statusCode && res.statusCode >= 400) {\n          reject(new Error(`Update check failed: ${res.statusCode}`));\n          return;\n        }\n        let raw = \"\";\n        res.setEncoding(\"utf8\");\n        res.on(\"data\", (chunk) => {\n          raw += chunk;\n        });\n        res.on(\"end\", () => resolve(raw));\n      })\n      .on(\"error\", reject);\n  });\n};\n\nexport const compareVersions = (a: string, b: string) => {\n  const aParts = a.replace(/^v/i, \"\").split(\".\").map(Number);\n  const bParts = b.replace(/^v/i, \"\").split(\".\").map(Number);\n  const len = Math.max(aParts.length, bParts.length);\n  for (let i = 0; i < len; i += 1) {\n    const aVal = aParts[i] ?? 0;\n    const bVal = bParts[i] ?? 0;\n    if (aVal > bVal) return 1;\n    if (aVal < bVal) return -1;\n  }\n  return 0;\n};\n\nconst getPlatformMatchers = () => {\n  const platformMatchers: RegExp[] = [];\n  switch (process.platform) {\n    case \"win32\":\n      platformMatchers.push(/win32/i, /windows/i);\n      break;\n    case \"darwin\":\n      platformMatchers.push(/macos/i, /darwin/i, /osx/i, /mac/i);\n      break;\n    case \"linux\":\n      platformMatchers.push(/linux/i);\n      break;\n    case \"android\":\n      platformMatchers.push(/android/i);\n      break;\n    default:\n      platformMatchers.push(new RegExp(process.platform, \"i\"));\n      break;\n  }\n\n  const archMatchers: RegExp[] = [];\n  switch (process.arch) {\n    case \"x64\":\n      archMatchers.push(/x86_64/i, /amd64/i);\n      break;\n    case \"ia32\":\n      archMatchers.push(/i686/i, /x86(?!_64)/i);\n      break;\n    case \"arm64\":\n      archMatchers.push(/arm64/i, /aarch64/i);\n      break;\n    case \"arm\":\n      archMatchers.push(/armv7/i, /arm(?!64)/i);\n      break;\n    default:\n      archMatchers.push(new RegExp(process.arch, \"i\"));\n      break;\n  }\n\n  return { platformMatchers, archMatchers };\n};\n\nconst selectReleaseAsset = (assets: ReleaseAsset[]) => {\n  const { platformMatchers, archMatchers } = getPlatformMatchers();\n  return assets.find((asset) => {\n    if (asset.name.endsWith(\".asc\") || asset.name.endsWith(\".sig\")) return false;\n    const platformMatch = platformMatchers.some((pattern) => pattern.test(asset.name));\n    const archMatch = archMatchers.some((pattern) => pattern.test(asset.name));\n    return platformMatch && archMatch;\n  });\n};\n\nconst checkTorUpdates = async (): Promise<UpdateCheckResult> => {\n  const indexHtml = await fetchText(\"https://dist.torproject.org/torbrowser/\");\n  const versions = Array.from(indexHtml.matchAll(/href=\"(\\d+\\.\\d+\\.\\d+)\\//g)).map(\n    (match) => match[1]\n  );\n  const latest = versions.sort(compareVersions).at(-1);\n  if (!latest) {\n    return { version: null, assetName: null, downloadUrl: null, sha256: null };\n  }\n  const assetName = getTorAssetName(latest);\n  const sha256 = getPinnedSha256(\"tor\", { version: latest, assetName });\n  if (!sha256) {\n    return {\n      version: latest,\n      assetName,\n      downloadUrl: getTorAssetUrl(latest),\n      sha256: null,\n      errorCode: \"PINNED_HASH_MISSING\",\n    };\n  }\n  return {\n    version: latest,\n    assetName,\n    downloadUrl: getTorAssetUrl(latest),\n    sha256,\n  };\n};\n\nconst checkLokinetUpdates = async (): Promise<UpdateCheckResult> => {\n  const url = \"https://api.github.com/repos/oxen-io/lokinet/releases/latest\";\n  const release = await fetchJson<ReleaseResponse>(url);\n  const version = release.tag_name.replace(/^v/i, \"\");\n  const asset = selectReleaseAsset(release.assets);\n  if (!asset) {\n    return {\n      version: null,\n      assetName: null,\n      downloadUrl: null,\n      sha256: null,\n      errorCode: \"ASSET_NOT_FOUND\",\n    };\n  }\n  const sha256 = getPinnedSha256(\"lokinet\", { version, assetName: asset.name });\n  if (!sha256) {\n    return {\n      version,\n      assetName: asset.name,\n      downloadUrl: asset.browser_download_url,\n      sha256: null,\n      errorCode: \"PINNED_HASH_MISSING\",\n    };\n  }\n  return {\n    version,\n    assetName: asset.name,\n    downloadUrl: asset.browser_download_url,\n    sha256,\n  };\n};\n\nexport const checkUpdates = async (network: OnionNetwork) => {\n  if (network === \"tor\") {\n    return checkTorUpdates();\n  }\n  return checkLokinetUpdates();\n};\n","import { app, BrowserWindow, ipcMain, net, session } from \"electron\";\nimport fs from \"node:fs/promises\";\nimport fsSync from \"node:fs\";\nimport path from \"node:path\";\nimport { fileURLToPath } from \"node:url\";\nimport type { OnionComponentState, OnionNetwork } from \"./net/netConfig\";\nimport { installTor } from \"./main/onion/install/installTor\";\nimport { installLokinet } from \"./main/onion/install/installLokinet\";\nimport { readCurrentPointer } from \"./main/onion/install/swapperRollback\";\nimport { OnionRuntime } from \"./main/onion/runtime/onionRuntime\";\nimport { checkUpdates } from \"./main/onion/update/checkUpdates\";\nimport { PinnedHashMissingError } from \"./main/onion/errors\";\n\ntype ProxyApplyPayload = {\n  proxyUrl: string;\n  enabled: boolean;\n  allowRemote: boolean;\n};\n\ntype ProxyHealth = {\n  ok: boolean;\n  message: string;\n};\n\nconst isDev = !app.isPackaged;\n\nconst isLocalhostProxyUrl = (proxyUrl: string) => {\n  try {\n    const parsed = new URL(proxyUrl);\n    return parsed.hostname === \"127.0.0.1\" || parsed.hostname === \"localhost\";\n  } catch (error) {\n    return false;\n  }\n};\n\nconst applyProxy = async ({ proxyUrl, enabled, allowRemote }: ProxyApplyPayload) => {\n  if (!enabled) {\n    await session.defaultSession.setProxy({ mode: \"direct\" });\n    return;\n  }\n  if (!isLocalhostProxyUrl(proxyUrl) && !allowRemote) {\n    throw new Error(\"Remote proxy URL blocked\");\n  }\n  await session.defaultSession.setProxy({ proxyRules: proxyUrl });\n};\n\nconst checkProxy = async (): Promise<ProxyHealth> => {\n  const resolve = await session.defaultSession.resolveProxy(\"https://example.com\");\n  const hasProxy = resolve.includes(\"PROXY\") || resolve.includes(\"SOCKS\");\n  if (!hasProxy) {\n    return { ok: false, message: \"proxy-not-applied\" };\n  }\n\n  return new Promise((resolvePromise) => {\n    const request = net.request(\"https://example.com\");\n    request.on(\"response\", () => resolvePromise({ ok: true, message: \"ok\" }));\n    request.on(\"error\", () => resolvePromise({ ok: false, message: \"unreachable\" }));\n    request.end();\n  });\n};\n\nexport const registerProxyIpc = () => {\n  ipcMain.handle(\"proxy:apply\", async (_event, payload: ProxyApplyPayload) => {\n    await applyProxy(payload);\n  });\n  ipcMain.handle(\"proxy:check\", async () => {\n    return checkProxy();\n  });\n};\n\ntype OnionStatusPayload = {\n  components: {\n    tor: OnionComponentState;\n    lokinet: OnionComponentState;\n  };\n  runtime: ReturnType<OnionRuntime[\"getStatus\"]>;\n};\n\nconst onionRuntime = new OnionRuntime();\nconst onionComponentCache: Record<OnionNetwork, OnionComponentState> = {\n  tor: { installed: false, status: \"idle\" },\n  lokinet: { installed: false, status: \"idle\" },\n};\n\nconst refreshComponentState = async (userDataDir: string, network: OnionNetwork) => {\n  const pointer = await readCurrentPointer(userDataDir, network);\n  return {\n    ...onionComponentCache[network],\n    installed: Boolean(pointer),\n    version: pointer?.version,\n  };\n};\n\nconst emitOnionProgress = (\n  event: Electron.IpcMainInvokeEvent,\n  network: OnionNetwork,\n  status: OnionComponentState\n) => {\n  event.sender.send(\"onion:progress\", { network, status });\n};\n\nconst registerOnionIpc = () => {\n  ipcMain.handle(\"onion:status\", async () => {\n    const userDataDir = app.getPath(\"userData\");\n    return {\n      components: {\n        tor: await refreshComponentState(userDataDir, \"tor\"),\n        lokinet: await refreshComponentState(userDataDir, \"lokinet\"),\n      },\n      runtime: onionRuntime.getStatus(),\n    } satisfies OnionStatusPayload;\n  });\n\n  ipcMain.handle(\"onion:checkUpdates\", async () => {\n    const userDataDir = app.getPath(\"userData\");\n    const torUpdate = await checkUpdates(\"tor\");\n    const lokinetUpdate = await checkUpdates(\"lokinet\");\n    const torState = await refreshComponentState(userDataDir, \"tor\");\n    const lokinetState = await refreshComponentState(userDataDir, \"lokinet\");\n    const torHasVerifiedUpdate =\n      Boolean(torUpdate.version && torUpdate.sha256 && torUpdate.downloadUrl);\n    const lokinetHasVerifiedUpdate =\n      Boolean(lokinetUpdate.version && lokinetUpdate.sha256 && lokinetUpdate.downloadUrl);\n    onionComponentCache.tor = {\n      ...torState,\n      latest: torHasVerifiedUpdate ? torUpdate.version ?? undefined : undefined,\n      error: torUpdate.errorCode === \"PINNED_HASH_MISSING\" ? \"PINNED_HASH_MISSING\" : undefined,\n    };\n    onionComponentCache.lokinet = {\n      ...lokinetState,\n      latest: lokinetHasVerifiedUpdate ? lokinetUpdate.version ?? undefined : undefined,\n      error:\n        lokinetUpdate.errorCode === \"PINNED_HASH_MISSING\" ? \"PINNED_HASH_MISSING\" : undefined,\n    };\n    return {\n      components: {\n        tor: onionComponentCache.tor,\n        lokinet: onionComponentCache.lokinet,\n      },\n      runtime: onionRuntime.getStatus(),\n    } satisfies OnionStatusPayload;\n  });\n\n  ipcMain.handle(\"onion:install\", async (event, payload: { network: OnionNetwork }) => {\n    const userDataDir = app.getPath(\"userData\");\n    const network = payload.network;\n    try {\n      const updates = await checkUpdates(network);\n      if (updates.errorCode === \"PINNED_HASH_MISSING\") {\n        throw new PinnedHashMissingError(\n          `Missing pinned hash for ${network} ${updates.assetName ?? updates.version ?? \"unknown\"}`\n        );\n      }\n      if (!updates.version || !updates.sha256 || !updates.downloadUrl || !updates.assetName) {\n        throw new Error(\"No verified release available\");\n      }\n      onionComponentCache[network] = { ...onionComponentCache[network], status: \"downloading\" };\n      emitOnionProgress(event, network, onionComponentCache[network]);\n      const install =\n        network === \"tor\"\n          ? installTor(\n              userDataDir,\n              updates.version,\n              (progress) => {\n              onionComponentCache[network] = {\n                ...onionComponentCache[network],\n                status: progress.step === \"download\" ? \"downloading\" : \"installing\",\n              };\n              emitOnionProgress(event, network, onionComponentCache[network]);\n              },\n              updates.downloadUrl ?? undefined,\n              updates.assetName ?? undefined\n            )\n          : installLokinet(\n              userDataDir,\n              updates.version,\n              (progress) => {\n              onionComponentCache[network] = {\n                ...onionComponentCache[network],\n                status: progress.step === \"download\" ? \"downloading\" : \"installing\",\n              };\n              emitOnionProgress(event, network, onionComponentCache[network]);\n              },\n              updates.downloadUrl ?? undefined,\n              updates.assetName ?? undefined\n            );\n      const result = await install;\n      onionComponentCache[network] = {\n        ...onionComponentCache[network],\n        installed: true,\n        status: \"ready\",\n        version: result.version,\n        error: undefined,\n      };\n      emitOnionProgress(event, network, onionComponentCache[network]);\n    } catch (error) {\n      if (error instanceof PinnedHashMissingError) {\n        console.warn(\"Pinned hash missing for install\", error.details);\n      } else {\n        console.error(\"Onion install failed\", error);\n      }\n      onionComponentCache[network] = {\n        ...onionComponentCache[network],\n        status: \"failed\",\n        error:\n          error instanceof PinnedHashMissingError\n            ? error.code\n            : error instanceof Error\n              ? error.message\n              : String(error),\n      };\n      emitOnionProgress(event, network, onionComponentCache[network]);\n      throw error;\n    }\n  });\n\n  ipcMain.handle(\"onion:applyUpdate\", async (event, payload: { network: OnionNetwork }) => {\n    const network = payload.network;\n    const state = onionComponentCache[network];\n    if (!state.latest) {\n      throw new Error(\"No update available\");\n    }\n    const updateInfo = await checkUpdates(network);\n    if (updateInfo.errorCode === \"PINNED_HASH_MISSING\") {\n      throw new PinnedHashMissingError(\n        `Missing pinned hash for ${network} ${updateInfo.assetName ?? updateInfo.version ?? \"unknown\"}`\n      );\n    }\n    if (!updateInfo.version || !updateInfo.sha256 || !updateInfo.downloadUrl || !updateInfo.assetName) {\n      throw new Error(\"No verified release available\");\n    }\n    const updateVersion = updateInfo.version ?? state.latest;\n    if (!updateVersion) {\n      throw new Error(\"No verified release available\");\n    }\n    const userDataDir = app.getPath(\"userData\");\n    try {\n      const install =\n        network === \"tor\"\n          ? installTor(\n              userDataDir,\n              updateVersion,\n              (progress) => {\n                onionComponentCache[network] = {\n                  ...onionComponentCache[network],\n                  status: progress.step === \"download\" ? \"downloading\" : \"installing\",\n                };\n                emitOnionProgress(event, network, onionComponentCache[network]);\n              },\n              updateInfo.downloadUrl ?? undefined,\n              updateInfo.assetName ?? undefined\n            )\n          : installLokinet(\n              userDataDir,\n              updateVersion,\n              (progress) => {\n                onionComponentCache[network] = {\n                  ...onionComponentCache[network],\n                  status: progress.step === \"download\" ? \"downloading\" : \"installing\",\n                };\n                emitOnionProgress(event, network, onionComponentCache[network]);\n              },\n              updateInfo.downloadUrl ?? undefined,\n              updateInfo.assetName ?? undefined\n            );\n      const result = await install;\n      const runtime = onionRuntime.getStatus();\n      if (runtime.status === \"running\" && runtime.network === network) {\n        try {\n          await onionRuntime.start(userDataDir, network);\n        } catch (error) {\n          await result.rollback();\n          await onionRuntime.start(userDataDir, network);\n          throw error;\n        }\n      }\n      onionComponentCache[network] = {\n        ...onionComponentCache[network],\n        installed: true,\n        status: \"ready\",\n        version: result.version,\n        error: undefined,\n      };\n      emitOnionProgress(event, network, onionComponentCache[network]);\n    } catch (error) {\n      if (error instanceof PinnedHashMissingError) {\n        console.warn(\"Pinned hash missing for update\", error.details);\n      } else {\n        console.error(\"Onion update failed\", error);\n      }\n      onionComponentCache[network] = {\n        ...onionComponentCache[network],\n        status: \"failed\",\n        error:\n          error instanceof PinnedHashMissingError\n            ? error.code\n            : error instanceof Error\n              ? error.message\n              : String(error),\n      };\n      emitOnionProgress(event, network, onionComponentCache[network]);\n      throw error;\n    }\n  });\n\n  ipcMain.handle(\"onion:uninstall\", async (_event, payload: { network: OnionNetwork }) => {\n    const network = payload.network;\n    await onionRuntime.stop();\n    const userDataDir = app.getPath(\"userData\");\n    const componentRoot = path.join(userDataDir, \"onion\", \"components\", network);\n    await fs.rm(componentRoot, { recursive: true, force: true });\n    onionComponentCache[network] = { installed: false, status: \"idle\" };\n  });\n\n  ipcMain.handle(\n    \"onion:setMode\",\n    async (_event, payload: { enabled: boolean; network: OnionNetwork }) => {\n      const userDataDir = app.getPath(\"userData\");\n      if (!payload.enabled) {\n        await onionRuntime.stop();\n        return;\n      }\n      await onionRuntime.start(userDataDir, payload.network);\n    }\n  );\n};\n\nconst __dirname = path.dirname(fileURLToPath(import.meta.url));\nconst rendererUrl = process.env.VITE_DEV_SERVER_URL;\nlet mainWindow: BrowserWindow | null = null;\n\nconst canReach = async (url: string, timeoutMs = 1200) =>\n  new Promise<boolean>((resolve) => {\n    try {\n      const request = net.request(url);\n      const timeout = setTimeout(() => {\n        try {\n          request.abort();\n        } catch {}\n        resolve(false);\n      }, timeoutMs);\n      request.on(\"response\", (response) => {\n        const ok = Boolean(response.statusCode && response.statusCode >= 200 && response.statusCode < 400);\n        response.on(\"data\", () => {});\n        response.on(\"end\", () => {\n          clearTimeout(timeout);\n          resolve(ok);\n        });\n      });\n      request.on(\"error\", () => {\n        clearTimeout(timeout);\n        resolve(false);\n      });\n      request.end();\n    } catch (error) {\n      resolve(false);\n    }\n  });\n\nexport const createMainWindow = () => {\n  if (mainWindow && !mainWindow.isDestroyed()) {\n    mainWindow.show();\n    mainWindow.focus();\n    return mainWindow;\n  }\n  const preloadPath = path.join(__dirname, \"preload.js\");\n  const preloadExists = fsSync.existsSync(preloadPath);\n  if (isDev && !preloadExists) {\n    console.error(\"[dev] preload missing at\", preloadPath);\n  }\n  const sandboxEnabled = !(isDev && process.env.ELECTRON_DEV_NO_SANDBOX === \"1\");\n  const win = new BrowserWindow({\n    width: 1280,\n    height: 800,\n    webPreferences: {\n      preload: preloadExists ? preloadPath : undefined,\n      contextIsolation: true,\n      nodeIntegration: false,\n      sandbox: sandboxEnabled,\n      allowRunningInsecureContent: false,\n    },\n  });\n  win.webContents.on(\"did-fail-load\", (_event, errorCode, errorDesc, validatedURL) => {\n    console.error(\"[main] did-fail-load\", errorCode, errorDesc, validatedURL);\n  });\n  win.webContents.on(\"render-process-gone\", (_event, details) => {\n    console.error(\"[main] render-process-gone\", details);\n  });\n  win.webContents.on(\"unresponsive\", () => {\n    console.error(\"[main] renderer unresponsive\");\n  });\n  if (isDev) {\n    win.webContents.on(\"console-message\", (_event, level, message, line, sourceId) => {\n      console.log(\"[renderer]\", level, message, sourceId, line);\n    });\n  }\n\n  const loadRenderer = async () => {\n    if (rendererUrl) {\n      console.log(\"[dev] rendererUrl =\", rendererUrl);\n      const ok = await canReach(rendererUrl);\n      if (ok) {\n        console.log(\"[dev] loadURL =\", rendererUrl);\n        void win.loadURL(rendererUrl);\n        return;\n      }\n      console.error(\"[dev] vite not reachable\", rendererUrl);\n    }\n    if (isDev) {\n      const fallbackUrl = \"http://localhost:5173/\";\n      const ok = await canReach(fallbackUrl);\n      if (ok) {\n        console.log(\"[dev] loadURL =\", fallbackUrl);\n        void win.loadURL(fallbackUrl);\n        return;\n      }\n      const distIndex = path.join(__dirname, \"../dist/index.html\");\n      if (fsSync.existsSync(distIndex)) {\n        console.log(\"[dev] loadFile =\", distIndex);\n        void win.loadFile(distIndex);\n        return;\n      }\n      const html = `<!doctype html><html><head><meta charset=\"utf-8\" /><title>Dev Server Unavailable</title></head><body style=\"font-family:sans-serif;padding:16px;\"><h2>Dev server not reachable</h2><p>Start Vite on http://localhost:5173 and reload.</p></body></html>`;\n      console.log(\"[dev] loadURL = dev fallback page\");\n      void win.loadURL(`data:text/html;charset=utf-8,${encodeURIComponent(html)}`);\n      return;\n    }\n    void win.loadFile(path.join(__dirname, \"../dist/index.html\"));\n  };\n  void loadRenderer();\n  if (process.env.OPEN_DEV_TOOLS) {\n    win.webContents.openDevTools({ mode: \"detach\" });\n  }\n  mainWindow = win;\n  win.on(\"closed\", () => {\n    mainWindow = null;\n  });\n  return win;\n};\n\nconst gotTheLock = app.requestSingleInstanceLock();\nif (!gotTheLock) {\n  app.quit();\n  process.exit(0);\n} else {\n  app.on(\"second-instance\", () => {\n    if (mainWindow && !mainWindow.isDestroyed()) {\n      if (mainWindow.isMinimized()) mainWindow.restore();\n      mainWindow.show();\n      mainWindow.focus();\n      return;\n    }\n    createMainWindow();\n  });\n}\n\nif (process.env.VITE_DEV_SERVER_URL) {\n  const temp = app.getPath(\"temp\");\n  const devRoot = path.join(temp, \"nkc-electron-dev\");\n  const devUserData = path.join(devRoot, \"userData\");\n  const devCache = path.join(devRoot, \"cache\");\n  const devSession = path.join(devRoot, \"sessionData\");\n  const devTemp = path.join(devRoot, \"temp\");\n  fsSync.mkdirSync(devUserData, { recursive: true });\n  fsSync.mkdirSync(devCache, { recursive: true });\n  fsSync.mkdirSync(devSession, { recursive: true });\n  fsSync.mkdirSync(devTemp, { recursive: true });\n  app.setPath(\"userData\", devUserData);\n  app.setPath(\"sessionData\", devSession);\n  app.setPath(\"temp\", devTemp);\n  console.log(\"[dev] userData =\", app.getPath(\"userData\"), \"temp =\", app.getPath(\"temp\"));\n}\n\napp.whenReady().then(() => {\n  if (isDev) {\n    console.log(\"[main] VITE_DEV_SERVER_URL =\", process.env.VITE_DEV_SERVER_URL ?? \"\");\n  }\n  registerProxyIpc();\n  registerOnionIpc();\n  createMainWindow();\n  app.on(\"activate\", () => {\n    if (BrowserWindow.getAllWindows().length === 0) {\n      createMainWindow();\n    }\n  });\n});\n\napp.on(\"before-quit\", () => console.log(\"[main] before-quit\"));\napp.on(\"will-quit\", () => console.log(\"[main] will-quit\"));\napp.on(\"quit\", (_event, code) => console.log(\"[main] quit\", code));\n\napp.on(\"window-all-closed\", () => {\n  if (process.platform !== \"darwin\") {\n    app.quit();\n  }\n});\n"],"names":["fs","resolveDownload","net","__dirname"],"mappings":"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"}